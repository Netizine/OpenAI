<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Projects\Netizine.OpenAI\tests\Netizine.OpenAI.Tests\Infrastructure\Public\OpenAIConfigurationTest.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
namespace OpenAI.Tests
{
    using System;
    using System.Net;
    using System.Net.Http;
    using System.Threading;
    using System.Threading.Tasks;
    using OpenAI;
    using Xunit;

    public class OpenAIConfigurationTest : BaseOpenAITest
    {
        [Fact]
        public void OpenAIClient_Getter_CreatesNewOpenAIClientIfNullAndApiKeyIsSet()
        {
            var origApiKey = OpenAIConfiguration.ApiKey;
            var origOrganizationId = OpenAIConfiguration.OrganizationId;

            try
            {
                OpenAIConfiguration.ApiKey = &quot;sk_key_openaiconfiguration&quot;;
                OpenAIConfiguration.OrganizationId = &quot;ca_openaiconfiguration&quot;;
                OpenAIConfiguration.OpenAIClient = null;

                var client = OpenAIConfiguration.OpenAIClient;
                Assert.NotNull(client);
                Assert.Equal(OpenAIConfiguration.ApiKey, client.ApiKey);
                Assert.Equal(OpenAIConfiguration.OrganizationId, client.OrganizationId);
            }
            finally
            {
                OpenAIConfiguration.ApiKey = origApiKey;
                OpenAIConfiguration.OrganizationId = origOrganizationId;
            }
        }

        [Fact]
        public void OpenAIClient_Getter_CreatesNewOpenAIClientIfNullAndApiKeyIsNull()
        {
            var origApiKey = OpenAIConfiguration.ApiKey;

            try
            {
                OpenAIConfiguration.ApiKey = null;
                OpenAIConfiguration.OpenAIClient = null;

                var client = OpenAIConfiguration.OpenAIClient;
                Assert.NotNull(client);
                Assert.Null(client.ApiKey);
            }
            finally
            {
                OpenAIConfiguration.ApiKey = origApiKey;
            }
        }

        [Fact]
        public void OpenAIClient_Getter_ThrowsIfClientIsNullAndApiKeyIsEmpty()
        {
            var origApiKey = OpenAIConfiguration.ApiKey;

            try
            {
                OpenAIConfiguration.ApiKey = string.Empty;
                OpenAIConfiguration.OpenAIClient = null;

                var exception = Assert.Throws&lt;OpenAIException&gt;(() =&gt;
                    OpenAIConfiguration.OpenAIClient);
                Assert.Contains(&quot;Your API key is invalid, as it is an empty string.&quot;, exception.Message);
            }
            finally
            {
                OpenAIConfiguration.ApiKey = origApiKey;
            }
        }

        [Fact]
        public void OpenAIClient_Getter_ThrowsIfClientIsNullAndApiKeyContainsWhitespace()
        {
            var origApiKey = OpenAIConfiguration.ApiKey;

            try
            {
                OpenAIConfiguration.ApiKey = &quot;sk_openaiconfiguration\n&quot;;
                OpenAIConfiguration.OpenAIClient = null;

                var exception = Assert.Throws&lt;OpenAIException&gt;(() =&gt;
                    OpenAIConfiguration.OpenAIClient);
                Assert.Contains(&quot;Your API key is invalid, as it contains whitespace.&quot;, exception.Message);
            }
            finally
            {
                OpenAIConfiguration.ApiKey = origApiKey;
            }
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[16,13,16,57,1],[17,13,17,73,1],[21,17,21,75,1],[22,17,22,79,1],[23,17,23,57,1],[25,17,25,63,1],[26,17,26,40,1],[27,17,27,73,1],[28,17,28,89,1],[29,13,29,14,1],[32,17,32,57,1],[33,17,33,73,1],[34,13,34,14,1],[35,9,35,10,1],[40,13,40,57,1],[44,17,44,51,1],[45,17,45,57,1],[47,17,47,63,1],[48,17,48,40,1],[49,17,49,44,1],[50,13,50,14,1],[53,17,53,57,1],[54,13,54,14,1],[55,9,55,10,1],[60,13,60,57,1],[64,17,64,59,1],[65,17,65,57,1],[67,17,68,21,1],[68,21,68,53,1],[68,53,68,55,1],[69,17,69,106,1],[70,13,70,14,1],[73,17,73,57,1],[74,13,74,14,1],[75,9,75,10,1],[80,13,80,57,1],[84,17,84,73,1],[85,17,85,57,1],[87,17,88,21,1],[88,21,88,53,1],[88,53,88,55,1],[89,17,89,107,1],[90,13,90,14,1],[93,17,93,57,1],[94,13,94,14,1],[95,9,95,10,1]]);
    </script>
  </body>
</html>